function Plot_ParetoAndNormalFit(ParetoTailsDist,NormalDist,Returns,tailFraction)% Copyright 2014 The MathWorks, Inc.

minProbability = ParetoTailsDist.cdf((min(Returns)));maxProbability = ParetoTailsDist.cdf((max(Returns)));pSpan = linspace(minProbability  , maxProbability , 200); % spans distributionpLowerTail = linspace(minProbability  , tailFraction    , 200); % sample lower tailpUpperTail = linspace(1 - tailFraction, maxProbability  , 200); % sample upper tailpInterior  = linspace(tailFraction    , 1 - tailFraction, 200); % sample interiorfigure, subplot(2,1,1)hold onplot(ParetoTailsDist.icdf(pLowerTail), pLowerTail, 'red'  , 'LineWidth', 2)plot(ParetoTailsDist.icdf(pInterior) , pInterior , 'black', 'LineWidth', 2)plot(ParetoTailsDist.icdf(pUpperTail), pUpperTail, 'blue' , 'LineWidth', 2)xlabel('Returns'), ylabel('Probability'), title('\bf Empirical CDF')legend({'Pareto Lower Tail' 'Kernel Smoothed Interior' ...        'Pareto Upper Tail'}, 'Location', 'NorthWest')subplot(2,1,2)plot(ParetoTailsDist.icdf(pSpan), pSpan, 'k')hold('on'); plot(NormalDist.icdf(pSpan),pSpan,'g')[F,x] = ecdf(Returns);                 % empirical CDFstairs(x, F, 'r'); grid('on')legend('Generalized Pareto Fit','Normal Fit','Empirical CDF','Location','SouthEast');xlabel('Exceedance'); ylabel('Probability');title('\bf Pareto Fit')